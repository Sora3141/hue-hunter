<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Hue Hunter | Ranking</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="top-fixed-ad">
        <script src="https://adm.shinobi.jp/s/3be4a74111b0e4660a4445b3864b1a35"></script>
    </div>

    <div id="main-container">
        <div class="header">
            <div class="score-label">SCORE</div>
            <h1 id="score-display">0</h1>
        </div>

        <div id="game-board"></div>
        <button id="back-to-result" onclick="showResult(false)">ÁµêÊûú„Å´Êàª„Çã</button>

        <div id="start-screen">
            <h1 class="game-title">HUE<br>HUNTER</h1>
            <div id="auth-ui">
                <div id="login-options">
                    <button id="btn-google-login" class="btn-start" onclick="login()">Google„Åß„É≠„Ç∞„Ç§„É≥</button>
                    <button id="btn-guest" class="btn-look" onclick="continueAsGuest()">„É≠„Ç∞„Ç§„É≥„Åõ„Åö„Å´ÈÅä„Å∂</button>
                    
                    <button id="btn-show-ranking" class="btn-ranking-toggle" onclick="toggleStartRanking()">üèÜ „É©„É≥„Ç≠„É≥„Ç∞„ÇíË°®Á§∫</button>

                    <div id="start-ranking-container" class="ranking-box" style="display:none;">
                        <div class="ranking-header">RANKING TOP 5</div>
                        <div id="start-ranking-list" class="ranking-list-text">Loading...</div>
                    </div>

                    <p class="auth-notice">‚Äª„É≠„Ç∞„Ç§„É≥„Åô„Çã„Å®Ë®òÈå≤„ÇíÂêåÊúü„Åß„Åç„Åæ„Åô</p>
                </div>

                <div id="setup-ui" style="display:none;">
                    <p id="welcome-msg"></p>
                    <input type="text" id="display-name" placeholder="Ë°®Á§∫Âêç„ÇíÂÖ•Âäõ" maxlength="8">
                    <button class="btn-start" onclick="startGame()">„Ç≤„Éº„É†ÈñãÂßã</button>

                    <button id="btn-show-ranking-setup" class="btn-ranking-toggle" onclick="toggleSetupRanking()">üèÜ „É©„É≥„Ç≠„É≥„Ç∞„ÇíË°®Á§∫</button>
                    <div id="setup-ranking-container" class="ranking-box" style="display:none;">
                        <div class="ranking-header">RANKING TOP 5</div>
                        <div id="setup-ranking-list" class="ranking-list-text">Loading...</div>
                    </div>
                </div>
            </div>
        </div>

        <div id="result-overlay">
            <div id="new-record-label" style="display:none;">‚òÖ NEW RECORD ‚òÖ</div>
            <div id="res-rank" class="rank-name">---</div>
            <div id="res-msg" class="msg-text">---</div>

            <div id="ranking-container" class="ranking-box">
                <div id="ranking-header-res" class="ranking-header">
                    <span>RANKING TOP 5</span>
                    <span id="login-status-res" style="font-size:0.6rem;">---</span>
                </div>
                <div id="ranking-list" class="ranking-list-text">Loading...</div>
            </div>

            <div id="ad-space">
                <script src="https://adm.shinobi.jp/s/fbe3608133af14816ff830129b4da30b"></script>
            </div>

            <div id="guest-login-notice" style="display:none;">
                <button onclick="login()" class="btn-sync-notice">Google„É≠„Ç∞„Ç§„É≥„Åó„Å¶ÂêåÊúü„ÇíÊúâÂäπÂåñ</button>
            </div>

            <div class="result-stats">
                <div class="stat-item">
                    <span class="stat-label">SCORE</span>
                    <span id="res-score" class="stat-value">0</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">BEST</span>
                    <span id="res-best" class="stat-value">0</span>
                </div>
            </div>

            <div class="btn-group">
                <button class="btn-restart" onclick="resetGame()">„ÇÇ„ÅÜ‰∏ÄÂ∫¶ÊåëÊà¶</button>
                <button class="btn-look" onclick="peekBoard()">Áõ§Èù¢„ÇíÁ¢∫Ë™ç„Åô„Çã</button>
            </div>
        </div>

        <div id="version-display">v6.0.0</div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, GoogleAuthProvider, signInWithPopup, signInWithRedirect, getRedirectResult, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        import { getFirestore, collection, doc, setDoc, getDoc, query, orderBy, limit, getDocs, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyB933UwRnTI71Vt4cNJDJxTApYtvCDBhOE",
            authDomain: "huehunterworld.firebaseapp.com",
            projectId: "huehunterworld",
            storageBucket: "huehunterworld.firebasestorage.app",
            messagingSenderId: "627186904630",
            appId: "1:627186904630:web:6a41bc37ef49fcca82f297"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        
        window.fb = { 
            auth, db, GoogleAuthProvider, signInWithPopup, 
            signInWithRedirect, getRedirectResult, onAuthStateChanged,
            collection, doc, setDoc, getDoc, query, orderBy, limit, getDocs, serverTimestamp 
        };
    </script>
    <script src="script.js"></script>
</body>
</html>